{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Enable Programmatic Access to Google Analytics Data","text":"<p>The Google Analytics Data API allows you to programmatically access your Google Analytics data. This can be useful if you want to do things like; automate data extraction, integrate analytics data into your applications, or perform advanced data analysis.</p> <p>This guide describes how to set up a Google Cloud project with the appropriate credentials, to enable fetching data using the Google Analytics Data API.</p>"},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>A Google Cloud account.</li> <li>A Google Analytics property to set up access to.</li> <li>gcloud command line tool installed. See the gcloud installation guide for instructions.</li> </ul>"},{"location":"#step-1-create-google-cloud-project","title":"Step 1: Create Google Cloud Project","text":"<p>To create a Google Cloud project:</p> <ol> <li> <p>Open the Google Cloud Console.</p> </li> <li> <p>Click on the Open Project Picker button () in the top left corner.</p> </li> <li> <p>Click on the New Project button.</p> <p></p> </li> <li> <p>Enter the following information:</p> <ul> <li>Project name</li> <li>If applicable, your Organization.</li> <li> <p>If applicable, a Location.</p> <p></p> </li> </ul> </li> <li> <p>Click Create, to create the project.</p> <p>Note</p> <p>If you have several Google accounts, make sure you are logged in with the account that you want to connect the project to.</p> </li> </ol>"},{"location":"#step-2-enable-google-analytics-data-api","title":"Step 2: Enable Google Analytics Data API","text":"<p>To enable the Google Analytics Data API for your project:</p> <ol> <li> <p>The new Google Cloud project is not automatically opened in the Console. To open the project, click on the Open Project Picker button () in the top left corner and select the project.</p> </li> <li> <p>Click on the hamburger menu in the top left corner and select APIs &amp; Services &gt; Enable APIs &amp; Services.</p> <p></p> </li> <li> <p>Click on the + Enable APIs and Services button.</p> </li> <li> <p>Enter Google Analytics Data API in the search bar and press Enter.</p> <p></p> </li> <li> <p>Click on Google Analytics Data API.</p> </li> <li> <p>Click on the Enable button, to enable the API for your project.</p> </li> </ol>"},{"location":"#step-3-create-service-account-and-keys","title":"Step 3: Create Service Account and Keys","text":"<p>API credentials are required to authenticate your requests. To create a service account and generate a key:</p> <ol> <li> <p>Click on the hamburger menu in the top left corner and select IAM &amp; Admin &gt; Service Accounts.</p> <p></p> </li> <li> <p>Click the + Create Service Account button.</p> </li> <li> <p>In the Create service account field, fill in fields:</p> <ul> <li>Service account name</li> <li>Service account ID (generated automatically)</li> <li>Service account description.</li> </ul> <p></p> </li> <li> <p>Click Create and continue.</p> </li> <li> <p>Set Permissions to Owner.</p> <p></p> </li> <li> <p>Do not set any Principals with access.</p> </li> <li> <p>Click Done to create the service account.</p> </li> <li> <p>Click on the newly created service account.</p> <p>For example: example-documentation@exampledocumentation.iam.gserviceaccount.com.</p> </li> <li> <p>Click Add key &gt; Create new key and select JSON. A JSON file with the key is downloaded to your computer.</p> <p>Warning</p> <p>Make sure that you store the key safely. This key provides access to all Google Analytics properties that you have granted.</p> </li> </ol>"},{"location":"#step-4-grant-access-to-the-service-account","title":"Step 4: Grant Access to the Service Account","text":"<p>For the service account to access your Google Analytics data, you need to grant access to the Google Analytics property.</p> <p>To grant access to the service account:</p> <ol> <li> <p>Open Google Analytics.</p> </li> <li> <p>Open the Google Analytics property that you want to connect to. Select the name of the property in the top right of Google Analytics. In the following image, the property is called GA4 - Google Merch Shop.</p> <p></p> </li> <li> <p>Click on Admin in the bottom left corner.</p> </li> <li> <p>In the Property column, click on Property Access Management.</p> <p></p> </li> <li> <p>Click the + button to add a new user.</p> </li> <li> <p>Enter the service account, in this example example-documentation@exampledocumentation.iam.gserviceaccount.com, and then click Add.</p> <p>Note</p> <p>You can share this email account with business partners and other users that you want to have access to your analytics data. There are no secrets or keys included in the email address.</p> </li> </ol>"},{"location":"#step-5-validation","title":"Step 5: Validation","text":"<p>You should now be able to access data by calling the Google Analytics Data API. To validate this, we will query the number of active users in the last 7 days by calling the <code>runReport</code> endpoint using curl.</p> <p>The <code>runReport</code> endpoint is used to fetch analytics data, like user counts, sessions, countries, and events for a Google Analytics property. This guide does not cover the full details of how to use the Google Analytics Data API. For full information on the endpoints request and response structure, see the <code>runReport</code> documentation. For instructions on how to work with the Google Analytics Data API, see the Google Analytics Data API documentation.</p> <p>To call <code>runReport</code> using curl:</p> <ol> <li> <p>Create an access token using gcloud and the JSON service account key file you downloaded in Create Service Account and Keys. </p> <p>Execute the commands below in your terminal. Replace <code>your-service-account-key.json</code> with the path to your service account key file.</p> <pre><code>gcloud auth activate-service-account --key-file=your-service-account-key.json\n\ngcloud auth print-access-token\n</code></pre> <p>This will print the token to be used in the <code>Authorization: Bearer &lt;YOUR_ACCESS_TOKEN&gt;</code> header.</p> </li> <li> <p>Get your Google Analytics Property ID. You can find it in the Google Analytics Admin section under Property Settings. It has the following format: G-XXXXXXXXXX.</p> </li> <li> <p>Use the below curl command to make the call. Replace <code>YOUR_PROPERTY_ID</code> with your Google Analytics property ID, and <code>YOUR_ACCESS_TOKEN</code> with the access token you created.</p> <p><pre><code>curl -X POST \\\n\"https://analyticsdata.googleapis.com/v1beta/properties/YOUR_PROPERTY_ID:runReport\" \\\n-H \"Authorization: Bearer $YOUR_ACCESS_TOKEN\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"dimensions\": [{\"name\": \"date\"}, {\"name\": \"country\"}],\n    \"metrics\": [{\"name\": \"activeUsers\"}],\n    \"dateRanges\": [{\"startDate\": \"7daysAgo\", \"endDate\": \"today\"}]\n}'\n</code></pre> In the above example we use fields <code>dimensions</code>, <code>metrics</code>, and <code>dateRanges</code> to specify the data we want to retrieve. The dimensions are <code>date</code> and <code>country</code>, the metric is <code>activeUsers</code>, and the date range is set to the last 7 days.</p> <p>More fields can be added to the request, see the <code>runReport</code> documentation for more information.</p> </li> <li> <p>Validate the response:</p> <ul> <li> <p>If successful, you should receive an output similar to what is shown below. For more information on the response structure of <code>runReport</code> see the RunReportResponse documentation.</p> <pre><code>{\n\"dimensionHeaders\": [\n    {\"name\": \"date\"},\n    {\"name\": \"country\"}\n],\n\"metricHeaders\": [\n    {\"name\": \"activeUsers\", \"type\": \"TYPE_INTEGER\"}\n],\n\"rows\": [\n    {\n    \"dimensionValues\": [{\"value\": \"20250717\"}, {\"value\": \"United States\"}],\n    \"metricValues\": [{\"value\": \"1234\"}]\n    },\n    ...\n]\n}\n</code></pre> </li> <li> <p>If unsuccessful, you will receive an error message. Common errors include:</p> <ul> <li><code>insufficientPermissions</code>: This means that the service account does not have access to the Google Analytics property. Make sure you have granted access to the service account in Create Service Account and Keys.</li> <li><code>invalidParameter</code>: This means that there is an issue with the request parameters. Check that you have provided the correct property ID and that the request body is correctly formatted.</li> </ul> </li> </ul> </li> </ol>"}]}